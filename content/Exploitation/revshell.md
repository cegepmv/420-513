+++
title = 'Shells inversés'
date = 2024-10-21T17:21:21-04:00
draft = false
weight = 61
+++

Nous avons vu un bref exemple des shells inversés à la première section avec la commande _netcat_. Mais cette commande est loin d'être la seule qu'on peut utiliser pour cette technique.

Un shell "direct" est une connexion distante normale, par exemple lorsqu'on utilise SSH pour se connecter sur un hôte. Le service SSH s'exécute sur l'hôte distant, on établit une connexion TCP sur ce serveur, on fournit des identifiants de connexion et on accède au compte de l'utilisateur. 

Il existe des cas où il est impossible de se connecter de cette manière:
- On ne connaît pas le nom ou le mot de passe d'un utilisateur
- Le service SSH est accessible uniquement sur le réseau local distant et un pare-feu bloque l'accès
- Le service SSH ne s'exécute pas sur l'hôte distant.

Dans toutes ces situations, un shell inversé peut nous aider.

Dans un shell inversé, on se met en mode "serveur": sur la machine locale, on ouvre un port et on attend une connexion. Il s'agit ensuite de trouver une manière d'exécuter un programme sur la machine distante qui se connectera sur ce port local. Cette connexion est ensuite utilisée pour accéder à la ligne de commande de l'utilisateur associé au processus qui a initié la connexion.

Il y a différentes manières d'établir une connexion avec un shell inversé; cela dépend de la configuration de la machine cible et des programmes qui y sont disponibles.

### Shells bash
Dans ce cas il s'agit d'utiliser des commandes "bash" pour établir la connexion. Ils sont souvent utilisés car _bash_ est disponible sur la plupart des serveurs web.

### Shells web
Les "web shells", écrits dans des langages comme PHP, ASP ou JSP, sont injectés dans des applications web vulnérables. Il s'agit généralement de remplacer un programme légitime dans le langage de programmation de l'application par un programme qui établit la connexion vers la machine attaquante.

### Shells en C
Certaines vulnérabilités reliées à la gestion de la mémoire en langage C permettent parfois d'injecter des instructions dans la mémoire du serveur. Ces instructions peuvent créer des connexions entranters utilisées dans un shell inversé.

### Shells en python
Le langage python, bien qu'il ne soit pas toujours utilisé pour initier la connexion d'un shell inversé, permet souvent d'enrichir les fonctionnalités d'un shell "de base".

­

### Références
- https://highon.coffee/blog/reverse-shell-cheat-sheet/

